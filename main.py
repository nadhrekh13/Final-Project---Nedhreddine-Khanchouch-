from fastapi import FastAPI, HTTPException\nfrom pydantic import BaseModel\nfrom typing import List, Optional\nimport os\n\napp = FastAPI()\n\n# Task model\nclass Task(BaseModel):\n    id: int\n    title: str\n    description: Optional[str] = None\n    completed: bool = False\n\n# File paths\nTASKS_FILE = "tasks.txt"\n\n# Load and save tasks functions\ndef load_tasks():\n    if not os.path.exists(TASKS_FILE):\n        return []\n    with open(TASKS_FILE, 'r') as file:\n        tasks = [Task(**eval(line.strip())) for line in file]\n    return tasks\n\ndef save_tasks(tasks):\n    with open(TASKS_FILE, 'w') as file:\n        for task in tasks:\n            file.write(str(task.dict()) + "\n")\n\n@app.get("/")\ndef read_root():\n    return {"message": "Welcome to the Task API"}\n\n@app.get("/tasks/", response_model=List[Task])\ndef get_all_tasks():\n    return load_tasks()\n\n@app.get("/tasks/{task_id}", response_model=Task)\ndef get_single_task(task_id: int):\n    tasks = load_tasks()\n    for task in tasks:\n        if task.id == task_id:\n            return task\n    raise HTTPException(status_code=404, detail="Task not found")\n\n@app.post("/tasks/", response_model=Task)\ndef create_task(task: Task):\n    tasks = load_tasks()\n    task.id = max([t.id for t in tasks], default=0) + 1\n    tasks.append(task)\n    save_tasks(tasks)\n    return task\n\n@app.put("/tasks/{task_id}", response_model=Task)\ndef update_task(task_id: int, task: Task):\n    tasks = load_tasks()\n    for i, t in enumerate(tasks):\n        if t.id == task_id:\n            tasks[i] = task\n            tasks[i].id = task_id  # Ensure the ID remains the same\n            save_tasks(tasks)\n            return tasks[i]\n    raise HTTPException(status_code=404, detail="Task not found")\n\n@app.delete("/tasks/{task_id}")\ndef delete_task(task_id: int):\n    tasks = load_tasks()\n    tasks = [t for t in tasks if t.id != task_id]\n    save_tasks(tasks)\n    return {"message": "Task deleted"}\n\n@app.get("/tasks/filter/")\ndef filter_tasks(completed: bool):\n    tasks = load_tasks()\n    return [t for t in tasks if t.completed == completed]\n\n@app.delete("/tasks/")\ndef delete_all_tasks():\n    save_tasks([])  # Clear the tasks file\n    return {"message": "All tasks deleted"}\n\n@app.get("/tasks/stats/")\ndef get_task_statistics():\n    tasks = load_tasks()\n    total_tasks = len(tasks)\n    completed_tasks = len([t for t in tasks if t.completed])\n    return {\n        "total_tasks": total_tasks,\n        "completed_tasks": completed_tasks,\n        "pending_tasks": total_tasks - completed_tasks\n    }\n